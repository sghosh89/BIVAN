---
title: "The importance of a complete statistical description of dependence between variables for ecology and related fields"
author: "Shyamolina Ghosh, Mark T. Holder, Terrance E. Loecke, Daniel C. Reuman"
date: "February 18, 2018"
geometry: "left=1.5cm,right=1.5cm,top=2.5cm,bottom=2.8cm"

output: 
  pdf_document:
    number_sections: no
    keep_tex: yes
    fig_caption: yes
    includes:
      in_header: head_maintext.sty
      
tables: True
link-citations: True
urlcolor : blue

csl: ecology-letters.csl
bibliography: REF_ALL.bib
---

<!--**DAN: right now we sometimes use the terminology "normal copula" and sometimes 
"Gaussin copula". Let's choose one and be consistent across the whole ms, including 
main text and supp mat. I am leaning toward "Gaussin copula" but could be convinced 
otherwise, it is just the consistency that I want to be sure we get to.-->

<!--**SG: I think normal copula would be better as "N" is the abbreviation for that but for "G" means gumbel not gaussian.
I made all "Gaussian" as "Normal" copula in both main and supmat.-->

updated on `r Sys.Date()`

```{r setup_Paper, echo=F}
knitr::opts_chunk$set(echo = TRUE, fig.pos = "H")
options(scipen = 1, digits = 5) #This option round all numbers appeared in the inline r code upto 5th digit
#seed<-101
#source("mtime.R") #A function needed for caching
```

# Front matter

*Affiliations:*

Ghosh: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66045, USA

Holder: Department of Ecology and Evolutionary Biology and Biodiversity Institute, University of Kansas, Lawrence, KS, 66045, USA

Loecke: Environmental Studies Program and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66047, USA

Reuman: Department of Ecology and Evolutionary Biology and Kansas Biological Survey, University of Kansas, Lawrence, KS, 66047, USA; Laboratory of Populations, Rockefeller University, 1230 York Ave, New York, NY, 10065, USA. 

*Possible alternative titles:*

- A complete statistical description of dependence between variables for ecology and related fields

*Keywords:*

*Type of Article*

- Ideas and Perspectives

*The number of words in the abstract*

*The number of words in the main text (excluding abstract, acknowledgements, references, table and figure legends)* 

*The number of words in each text box*

*The number of references*

*The number of figures, tables, and text boxes*

*The name and complete mailing address (including telephone and fax numbers and e-mail address) of the person to whom correspondence should be sent* 

\newpage
# Abstract

We introduce a new rank based "copula" approach to model dependencies between ecological variables. Our method could overcome the shortcomings of linear correlation approach and give us new insight about "asymmetric tail dependence" found in ecology, biogeochemistry and related field. We focus on three objectives (1) Do datasets in ecology and related fields have non-Normal copula srtructure? Do they show tail dependence distinct from that of a Normal copula, and in particular do they show asymmetric
tail dependence? (2) If so, what are some possible causes of non-Normal copula structure? And (3) what are the
consequences of non-Normal copula structure and tail dependence for our understanding of biology and for applications? We present several examples with real data which show asymmetric tail dependence in bivariate as well as multivariate non-Normal copulae. Asymmetric tail dependence can explain some important phenomena like "spatial synchrony", causal relationship between ecological variables (like species abundance and rainfall). We show "Moran-effect" and asymmetric sensitivity towards global environmental fluctuations could be the possible causes for non-Normal copula structures. We demonstrate with simulations and real data that non-Normal copulae have profound effects on spatial skewness of species abundances and slope from spatial Taylor's law.  Our method is new and could have potential in exploring some other related phenomena like effect of climate change on extinction risks of metapopulations.

\newpage
# Introduction \label{Intro}

Identifying and quantifying dependencies is the core of modelling in many applications, frequently found in finance and risk management. For many years, measuring and modeling dependencies has focused on the
Pearson correlation because of its ease in use. But correlation can provide little information about the underlying dependence structure in the case of asymmetric dependence (i.e., varying association between two variables) because it is a measure of linear association between two variables. It may be better to use rank-based correlation measures such as Kendall’s tau and Spearman’s rho instead of Pearson correlation, when the marginal distribution of the variables are highly non-Gaussian. The copula [@joe2014_dependence; @nelsen2007_copula], a ranked based dependence measurement between two variables, transforms non-uniformly distributed marginals in original variables to uniformly distributed marginals when joint distribution of ranked data is plotted. For example, in the first panel of Fig. \ref{fig_cop_pedag}, we showed the joint distribution of raw data (left) and copula data (right), where the marginals of raw data variables (x and y) were gamma distributed but in copula plot those marginals had uniform distribution. Copula plot was obtained by scaling individual ranked variables by a factor $(n+1)$ where $n$ was the number of sampling points, so that the copula was confined within a unit box. From now, we will call it as "normalized ranking". Using a "copula-based approach" as a dependence measure reflects more knowledge about the dependence structure instead of summarizing in just a single number, the linear correlation coefficient. It tells us about the tail-dependence of the variables, i.e., the association between extreme values of two variables. If smaller values of each variable are more correlated to each other, then the corresponding copula structure is said to have "lower tail-dependence" as shown in the first panel of Fig. \ref{fig_cop_pedag} copula plot (right). Similarly, an "upper tail-dependence" copula indicates stronger correlation between higher extreme variables in the raw data. Tail dependence occurs when the correlation between two variables increases as we get "further" in the tail (either or both) of the distribution. For example, in the middle panel of Fig. \ref{fig_cop_pedag}, different dependence structures, with same Kendall correlation $\tau = 0.5$, are shown which vary between dominantly upper tail dependent (lower tail - upper tail dependence being negative) to dominantly lower tail dependent (lower tail - upper tail dependence being positive) as we move along the row. Lower panel represents the similar scenario but with stronger correlation (Kendall's $\tau = 0.8$). So, the flexibility of copulae allows us to model more complex multivariate dependence structures by isolating marginal from joint distribution structures, with the capability of modeling a rich variety of tail behavior, such as tail dependence versus tail independence.<!--and reflection symmetry versus reflection asymmetry.--> To identify the kinds of copula structure found in real ecological data, we need to select candidate bivariate copulae from many existing parametric copula families. <!--A very flexible bivariate copula can itself become a welcome candidate in the pool of bivariate copulae to be selected from.--> Here, throughout our studies for different datasets we used a universal pool of 16 bivariate copula families (having exclusively lower, exclusively upper, both or neither tail dependence), mentioned in the \nameref{Methods}. 

Though a few examples have been found which shows copula approach to model dependencies in bioinformatics [@Kim2008], medical research [@Emura2016], a short period study of intersite dependence of rainfall data [@Serinaldi2008], a recent study on characterizing and assessing risks in drought management [@She2018] or monitoring changes in precipitation-extremes [@Goswami2018], the multivariate copula approach still, we believe, remains unexplored in ecology or related field and thus have potential scope to better capture the evolution of ecological time series data. 


In ecological perspective, when we find a dominantly lower (upper) tail dependence structure between two species abundance timeseries, it means both incidence are rare (abundant) synchronously. Again, if abundance of a species (say, species A) is associated with scarcity of another species (say, species B) then it can explain the causality or negative feedback of A on species B. If one variable is an environmental factor (like temperatute or rainfall) and another is an observable (like abundance of a species) then it can also explain the causal relationship between them. On a similar note, if a species' abundance time series from different sampling locations shows multivariate dependence structure, then we can analyze the "spatial data" as pairwise bivariate copula and find if there is any tail dependence or not. If those copula came up with asymmetric tail dependence, then it can be viewed as a new type to quantify "spatial synchrony" [@Liebhold2004; @walteretal2017], which is a celebrated phenomenon in population ecology. In this article, we analyzed the dependence structure for several bivariate and multivariate ecological, community and biogeochemical datasets. In addition to a copula based \nameref{Model_selection}, we also carried out a \nameref{NPA} with three different statistics to verify our model selection based results. 

We want to address the following questions. \textbf{(Q1)} Do datasets in ecology and related fields have non-Normal copula srtructure? Do they show tail dependence distinct from that of a Normal copula, and in particular do they show asymmetric tail dependence? \textbf{(Q2)} If so, what are some possible causes of non-Normal copula structure? And \textbf{(Q3)} what are the consequences of non-Normal copula structure and tail dependence for our understanding of biology and for applications? 
In \nameref{Data}, we described briefly about each bivariate and multivariate datasets we used to answer these questions and provided a detailed descriptions of implemented methods in \nameref{Methods}. In the \nameref{Results} section, we summarized our finidings for each datasets. Next two sections are focused on possible causes and consequences of non-Normal copula structure in ecology and related field with applications shown in real data as well as some simulations. Finally, we concluded in the \nameref{Discussion} section. 

\begin{figure}[!h]
\begin{center}
\includegraphics[width=4 cm,height=4 cm]{./Results/rawdata.pdf}
\includegraphics[width=4 cm,height=4 cm]{./Results/copdata.pdf}\\
\includegraphics[width=16 cm,height=8 cm]{./Results/copula_pedagog_fig_BB1.pdf}
\caption{First panel : raw data plot has non-uniform (gamma distributed) marginal whereas copula makes its marginal uniform and indicating lower tail dependence in joint distribution, Second and third panel : pedagogical figure showing BB1 copula with varying tail-dependence difference but of same Kendall's tau along each row and with same tail-dependence difference but of different Kendall's tau along each column.\label{fig_cop_pedag}}
\end{center}
\end{figure}

<!--# Material and methods \label{Material&Methods}-->

## Data \label{Data}  

<!--
Considered datasets ranged widely from population ecology, community ecology , evolutionary and biogeochemical sphere. 
We used four datasets in each category of bivariate (soil C and N data, BMR data, Anolis data, Ceder-creek experiment data) and multivariate (aphid-abundance data, aphid-firstflight data, plankton-abundance data and methane-flux data) examples. Details of each dataset used were given in \ref{SM-Data_detailed}.-->

For bivariate analysis we used four datasets which are briefly described as follows;
\textbf{(i)} to explore the dependence of **soil organic C** and total **soil N** across a wide geographic range (conterminous US), ecosystem type, and traceable methodology we used the RaCA (Rapid Carbon Assessment)
database [@Wills2014, **or Wills and Loecke pending???**]. Specifically, the soil organic C and total soil N
stocks (Mg C or N m$^{-2}$ ) to 1m of soil depth from the central pedon of the 5930 sites were included in this
study. Then, we used extensive set of basal metabolic rate data for \textbf{(ii)} birds [@Mcnab_2009] and \textbf{(iii)} mammals [@Mcnab_2008] as our second and third bivariate datasets to explore the dependence between log(BMR) and log(mass) of respective species. \textbf{(iv)} We used [plant above ground biomass](https://www.cedarcreek.umn.edu/research/data/dataset?ple120) and [plant species percent cover](https://www.cedarcreek.umn.edu/research/data/dataset?pce120) data from a biodiversity experiment [@Tilman2001; @Tilman2006] to calculate plant-aboveground biomass and Shannon's diversity index (H), averaged over each plot (9m by 9m), for year 2000. 

Similarly, we applied multivariate analysis on four spatial datasets; \textbf{(i)} aphid-count and \textbf{(ii)} aphid-firstflight date were extracted from the Rothamsted Insect Survey suction-trap data [@Macaulay1988, @Harrington2014]. These two annual timesries (1976-2010) measurements are from 11 locations acroos UK for 20 aphid species. We used the same data format as used by @Sheppard2016 for their analysis on the impact of climate on aphids' spatial synchrony. In our case, we chose species=10 [Name : "Green spruce aphid"] for aphid-abundance data and species=11 [Name : "Leaf-curling plum aphid"] for aphid-firstflight data and considered only those locations which had atleast 30 years of data (see Figure \ref{SM-fig_aphid_map}). \textbf{(iii)} Plankton-count data collected at 26 locations over the areas of the North Sea and British seas for 22 species and for 56 years (1958-2013). These data were obtained from the Continuous Plankton Recorder (CPR) data set and maintained by the Sir Alistair Hardy Foundation for Ocean Science (SAHFOS).
<!--The CPR is a device which is towed across the ocean behind a ship, filtering plankton from seawater with a continuously
unwinding silk ribbon. The ribbon was cut into 4 inch segments, each corresponding to a particular time and
location in the ocean. Organisms were identified and counted (possibly with sub-sampling) microscopically [@Colebrook1979]. All the samples available for a given variable in a given area in a given month of a given year were
averaged, producing a monthly time series for each year. Where data for a given month was unavailable the missing value was replaced with a median value for that month (drawn from all years in which data was available).--> [@Sheppard2017] converted monthly values to yearly values by averaging over all months. But here we only allowed maximum 4 months in a year with missing data which were replaced by median value for that month (drawn from all years in which data was available). We used data for species=16 [Name : "Ceratium furca"] from those locations which had atleast 45 years time series data (see Figure \ref{SM-fig_plankton_map}). \textbf{(iv)} Finally, methane ($CH_{4}$) fluxes between the soil or water surface and the troposphere were measured at the Great Miami Wetland Mitigation Bank ($36^{\circ}46^{'}51^{''}$ N, $84^{\circ}20^{'}26^{''}$ W) in Trotwood, Montgomery County, Ohio. Additional information on the history of the site and soil types is detailed in @Jarecke2016. Briefly, the closed static flux chamber method was used [@Holland1999] to measure $CH_{4}$ fluxes at 28 locations across a hydrologic gradient (upland to seasonal wetland) at daily to weekly interval from September 2015 to September 2016. **See and Smyth et al, pending for
additional details???** on greenhouse gas flux methods for this site. We threw out all locations that had fewer than 50 dates data.

## Statistical methods for detecting copula structure \label{Methods}

Question \hyperref[Intro]{\textbf{(Q1)}} from the \nameref{Intro} was answered via statistical analysis of the
data described above, using both model selection and nonparametric approaches.

### Model selection approach \label{Model_selection}

A model-selection approach based on likelihood and the Akaike Information Criterion (AIC) 
and Bayesian Information Criterion (BIC) was used to
help answer \hyperref[Intro]{\textbf{(Q1)}} from the \nameref{Intro}. 

For bivariate datasets 
$(x_i,y_i)$ for $i=1,...,n$ such as the soil C and N data, model selection involved several steps, 
most implemented using tools from the `VineCopula` package. Code combining these tools is in the
[`OurBiCopSelect`](https://github.com/sghosh89/BIVAN/blob/master/OurBiCopSelect.R) function and its dependencies in the [`BIVAN`](https://github.com/sghosh89/BIVAN) repository. 

First, we produced ranks 
$(\tilde{u}_i,\tilde{v}_i)$ where $\tilde{u}_i$ is the rank of $x_i$ in the set 
$\{x_i:i=1,...,n\}$ and $\tilde{v}_i$ is the rank of $y_i$ in the set $\{y_i:i=1,...,n\}$ and 
we set $u_i=\tilde{u}_i/(n+1)$ and $v_i=\tilde{v}_i/(n+1)$; further work was with the "normalized ranked variables" $u_i$ 
and $v_i$. Ranks $\tilde{u}_i$ and $\tilde{v}_i$ were $1$, for the 
smallest element, up to $n$, for the largest. 

Second, we did a test of the independence of the $u_i$ and $v_i$. Subsequent model 
selection algorithms are ineffective if data could not be distinguished from independent data 
since most or all bivariate copula families considered include the independent copula in the 
family or as a boundary case. The independence test was as implemented in the `BiCopIndTest`
function in `VineCopula`, the documentation of which reports the test uses the asymptotic normality of the statistic $|\tau|\sqrt{\frac{9n(n-1)}{2(2n+5)}}$, where $\tau$ is Kendall's tau statistic. If independence could be rejected ($0.05$ significance level), model selection proceeded.

The third step of model selection was to fit multiple bivariate copula families to the ranked data $(u_i,v_i)$ via maximum likelihood, using the `BiCopEst` function in `VineCopula`. Families considered (with abbreviations and numeric codes here indicated) included the **N**ormal/Gaussian {1}, **C**layton {3}, **G**umbel {4}, **F**rank {5}, **J**oe {6}, **BB1** {7}, **BB6** {8}, **BB7** {9}, **BB8** {10}, **S**urvival **C**layton {13}, **S**urvival **G**umbel {14}, **S**urvival **J**oe {16}, **S**urvival **BB1** {17}, **S**urvival **BB6** {18}, **S**urvival **BB7** {19} and **S**urvival **BB8** {20} copulae.
AIC and BIC values and accompanying model weights ($\text{AIC}_{\text{w}}$, $\text{BIC}_{\text{w}}$) were generated using standard formulas [@burnham2003_modelselection]. 
Descriptions of these copula families can be found in introductory texts on copulae [@nelsen2007_copula ; @joe2014_dependence]  and in `VineCopula` documentation. 
The lower- and upper-tail dependence of the 
best-fitting member of each family was also provided by `BiCopEst`.

Model selection methods will give the *relative* support of several models, but will not,
on their own, indicate whether any of the models selected is an objectively good fit (all 
models considered might poorly describe the data). To test this, and as the fourth step of
our procedure, we tested the goodness of fit of our best-AIC copula family using a 
bootstrapping procedure implemented in `BiCopGofTest` of `VineCopula`. The method performed 
two tests, one based on a Cramer-von Mises statistic, and one based on a 
Kolmogorov-Smirnov statistic. For computational efficiency, 
an initial run using $100$ bootstraps was performed, and if
the $p$-value resulting from either test was less than $0.2$, tests were re-run with 
$1000$ boostraps.

Finally, $\text{AIC}_{\text{w}}$ values for all fitted models were used to get
model-averaged lower- and upper-tail dependence values using standard model averaging 
formulas [@burnham2003_modelselection]; likewise for BIC.

The first part of \hyperref[Intro]{\textbf{(Q1)}} from the \nameref{Intro} was answered for a bivariate dataset 
$(x_i,y_i)$ for $i=1,...,n$ by comparing the AIC weights of the non-Normal copula
families with that of the Normal family. The same was also done using BIC.
The second part of \hyperref[Intro]{\textbf{(Q1)}} was answered by comparing 
the model-averaged lower- and upper-tail dependence
values to the lower- and upper-tail dependence values of a Normal copula, both of which 
are 0. The third part of \hyperref[Intro]{\textbf{(Q1)}}
was answered by comparing the difference of the model-averaged lower- and upper-tail 
dependence values to the analogous difference for a Normal copula, again 0.

For multivariate datasets, e.g., the aphid abundance or first flight data, 
each of which consists of time series from 10 selected locations, we carried out the same bivariate analysis
for all possible pairwise combinations of those locations and compared AIC-weights and tail-dependence of best-fit(minimum AIC) copula with that of the Normal copula. We also counted for how many location pairs model -averaged lower tail dependence is greater than model-averaged upper-tail dependence or vice-versa. 

<!--For example, for green-spruce aphid abundance data we found major lower tail dependence whereas leaf-curling plum aphid's first flight data had significant upper tail dependence at all location pairs (for details see Table \ref{tab_multivar_summary}).
***DAN: need to fill this in, prrobably enough to be brief, since these were just done 
pairwise
**SG: done-->

### Nonparametric analysis of tail dependence \label{NPA}

In addition to the model selection approach described above, **nonparametric approaches** to quantify lower ($\cor_l$, $\Ps_l$ and $\Dsq_l$ statistics) and upper tail dependence ($\cor_u$, $\Ps_u$ and $\Dsq_u$ statistics) were also used to answer \hyperref[Intro]{\textbf{(Q1)}}. Using two distinct methods, when results are consistent, provides greater confidence 
that results are robust. 
 
Left (or lower)- and right (or upper)-tail dependence quantify the extent to which two ranked
variables $u_i$, $v_i$ for $i=1,...,n$ 
(see \nameref{Model_selection} for defintions of $u_i$ and $v_i$)
are related to each other in the left and right tails, respectively, of their 
distributions [@nelsen2007_copula, @joe2014_dependence]. 
Our nonparametric study of tail dependence uses three
statistics which can quantify the extent to which $u_i$ and $v_i$ are 
related in any part of their distributions. We here describe the 
statistics. The statistics were formulated with positively associated
variables in mind. All the variables we study are positively associated
when they are significantly associated. So definitions and associated 
diagrams will assume positive associations, though generalizations are 
possible. Given two bounds 
$0 \leq l_b < u_b \leq 1$, we define the parallel lines $u+v=2l_b$ and 
$u+v=2u_b$ which intersect the unit square in which the $u_i$ and $v_i$ 
fall (these are the blue and red lines, respectively, in 
Fig. \ref{fig_stat_image}). Our statistics quantify the dependence
between $u_i$ and $v_i$ in the region bounded by these lines.
Using $l_b=0$ and some value $u_b\leq 0.5$ can give information about 
dependence in the left parts of the distributions of $u$ and $v$, and 
using $u_b=1$ and $l_b \geq 0.5$ can give information about dependence in 
the right parts of the distributions. 

\begin{figure}[!h]
\begin{center}
\includegraphics[width=6 cm,height=6 cm]{./stat_image.jpg} \hspace{0.6 cm}
\caption{Schematic diagram supporting defintions of nonparametric tail dependence statistics \label{fig_stat_image}}
\end{center}
\end{figure}


\textbf{(i)} The first quantity, $\cor_{l_b,u_b}(u,v)$, is the portion of the Spearman 
correlation of $u_i$ and $v_i$ that is attributable to the points 
lying in the region given by the bounds $u+v=2l_b$ and $u+v=2u_b$, i.e.,
\begin{equation}\label{eq.Cor}
   \cor_{l_b,u_b}(u,v) = \frac{1}{(n-1)\sqrt{\var(u)\var(v)}}\sum 
   (u_i-\mean(u)) (v_i-\mean(v)),
\end{equation}
where means and variances are computed using all $n$ data 
points, but the
sum is over only the indices $i$ for which $u_i+v_i > 2l_b$ and 
$u_i+v_i < 2u_b$. 
Larger values of $\cor_{l_b,u_b}$ indicate stronger positive association
between $u$ and $v$ in the region given by the bounds.

\textbf{(ii)} We also defined a statistic $\Ps_{l_b,u_b}$, using the same bounds
$u+v=2l_b$ and $u+v=2u_b$, as follows. For a distance $h$, we defined
$S(h)$ to be the number of points $(u_i,v_i)$ within the bounds 
and a distance less than $h$ from the line $v=u$, divided by the 
total number of points within the bounds. This function is
defined for $h$ going from $0$ to a distance $h_{\text{max}}$ which
is half the longer of the two segments obtained by intersecting the
bounds with the unit square. It is easy to see $S(0)=0$ and 
$S(h_{\text{max}})=1$. We defined $S_i(h)$, for the same range 
of $h$, to be the area within the bounds and the unit square
and within distance $h$ of the line $v=u$, divided by the area
within the bounds and the unit square. This is the expected value of
$S(h)$ for independent data. We then defined
\begin{equation}\label{eq.P}
   P_{l_b,u_b} = \int_0^{h_{max}} ( S(h) - S_i(h) ) dh.
\end{equation}
As for $\cor_{l_b,u_b}$, larger values of $\Ps_{l_b,u_b}$ 
indicate stronger positive association
between $u$ and $v$ in the region given by the bounds.

\textbf{(iii)} The third statistic, $\Dsq_{l_b,u_b}(u,v)$, is the average squared 
distance between points satisfying $u_i+v_i>2l_b$ and 
$u_i+v_i<2u_b$ and the line $v=u$. Unlike $\cor_{l_b,u_b}$ and 
$\Ps_{l_b,u_b}$, which are large when points satisfying $u_i+v_i>2l_b$ and 
$u_i+v_i<2u_b$ cluster close to the line $v=u$, $\Dsq_{l_b,u_b}$ is 
then small. 
Thus large values of $\cor_{l_b,u_b}$ and $\Ps_{l_b,u_b}$ indicate strong 
dependence in the portions of the distributions of $u$ and $v$ given by 
the bounds $u_i+v_i>2l_b$ and $u_i+v_i<2u_b$, whereas small values of 
$\Dsq_{l_b,u_b}$ indicate strong dependence. 

For large datasets (i.e., datasets with large $n$),
we can consider $l_b$ and $u_b$ close together without incurring undue
sampling variation in our statistics, and we can consider 
several different bands $(l_b,u_b)$ to understand how dependence
varies in different parts of the distributions. But for datasets with 
smaller $n$ we considered only $l_b=0$, $u_b=0.5$ and $l_b=0.5$, $u_b=1$.
We use the shorthand $\cor_l=\cor_{0,0.5}$ ($l$ is for "lower") 
and $\cor_u=\cor_{0.5,1}$ ($u$ is for "upper"); likewise $\Ps_l=\Ps_{0,.5}$,
$\Ps_u=\Ps_{0.5,1}$, $\Dsq_l=\Dsq_{0,0.5}$, and $\Dsq_u=\Dsq_{0.5,1}$.

The difference $\cor_l-\cor_u$ is expected to be positive if 
dependence in the left halves of the distributions is stronger 
than dependence in their right halves; likewise for $\Ps_l-\Ps_u$.
This holds, for instance, for the Clayton copula [@nelsen2007_copula].
The difference $\Dsq_u-\Dsq_l$, in which the "upper" and
"lower" statistics occur in opposite order, is also expected to be 
positive under the same conditions. We use these three differences
to detect asymmetry of tail dependence. Likewise, for large datasets,
we consider $\cor_{l_b,u_b}-\cor_{1-u_b,1-l_b}$, 
$\Ps_{l_b,u_b}-\Ps_{1-u_b,1-l_b}$ and
$\Dsq_{1-u_b,1-l_b}-\Dsq_{l_b,u_b}$ with $l_b=0$ and $u_b$ close to $0$.

We tested our statistics by testing whether $\cor_l-\cor_u$, $\Ps_l-\Ps_u$, and $\Dsq_u-\Dsq_l$ revealed the asymmetry of tail dependence known to be present in data simulated from various copulae (for details see Appendix \ref{SM-Test_npa_stat}).

For bivariate datasets, we compared values 
of the statistics $\cor_{l_b,u_b}$,
$\Ps_{l_b,u_b}$, $\Dsq_{l_b,u_b}$, $\cor_l-\cor_u$, $\Ps_l-\Ps_u$, and $\Dsq_u-\Dsq_l$ to 
distributions of values of the same statistics computed on surrogate datasets that were produced from 
the empirical data by randomizing it in a special way to have no tail dependence. The surrogate/randomized datasets had exactly 
the same marginal distributions as the empirical data and had very similar Kendall or Spearman 
correlation (the algorithm had two versions, one for preserving each correlation coefficient), 
but had Normal copula structure. Thus our comparisons tested the null hypothesis 
that our statistics took values on the empirical data no different from what would have been expected 
if the copula structure of the data were Normal, but the data were otherwise 
statistically unchanged.
Details of how surrogates were produced are in Appendix \ref{SM-surrog_test}, and code is in [`copsurrog2d`](https://github.com/sghosh89/BIVAN/blob/master/copsurrog2d.R).

The comparison of one of the
statistics $\cor_{l_b,u_b}$, $\Ps_{l_b,u_b}$, $\Dsq_{l_b,u_b}$, as computed on the 
empirical data, to the distribution
of its values computed on many surrogate datasets 
provides a test of whether dependence in the part of the distribution specified 
by $l_b$ and $u_b$ is different from
what would be expected from a null hypothesis of normal copula structure but 
unchanged marginals and unchanged 
Kendall (or Spearman)
correlation. Thus the comparison helps answer the first two parts of question \hyperref[Intro]{\textbf{(Q1)}} 
from the \nameref{Intro} for bivariate datasets. 
Significant deviations correspond to deviations from normal 
copula structure. In particular, deviations 
using $l_b=0$ and $u_b$ small (say, $0.1$) correspond to lower tail dependence 
different from that of a normal copula;
likewise, using $l_b=0.9$ and $u_b=1$ tests for upper tail dependence different 
from that of a normal copula.  

The comparison of one of the statistics $\cor_l-\cor_u$, $\Ps_l-\Ps_u$, $\Dsq_u-\Dsq_l$, 
as computed on the 
empirical data, to the distribution
of its values on many surrogate datasets 
provides a test of asymmetry of tail dependence. Thus this comparison helps answer the
third part of question \hyperref[Intro]{\textbf{(Q1)}} from the \nameref{Intro} for bivariate datasets.

For multivariate datasets, we used a spatial resampling scheme (for details see Appendix \ref{SM-spatial_resamp}) to calculate confidence intervals, instead of the surrogate 
approach described above.

<!--Theoretical models
Question 2 from the Introduction was explored using simple population models.-->
 
<!--# Application : copula structures in ecology, evolutionary and biogeochemical spheres \label{Results}-->
# Application : biological dependencies \label{Results}
<!--## question 1
- Do datasets in ecology and related fields have non-Normal copula structure?
- Do they show tail dependence distinct from that of a Normal copula?
- In particular do they show asymmetric tail dependence?--> 

To answer \hyperref[Intro]{\textbf{(Q1)}}, we chose one representative datasets for each category : with a bivariate (soil C and N data) and a multivariate (green spruce aphid-abundance data) dataset, we summarized our findings as follows.

## Results for bivariate data \label{Result_biv}

We summarized our results columnwise in Table \ref{tab_bivar_summary} for different kinds of bivariate datasets (biogeochemical, evolutionary and ecological data) that were plotted in Fig. \ref{fig_biv_multi_raw_cop}(A-H). For all $4$ bivariate-datasets indicated by each column name (SoilCN, Birds' BMR, Mammals' BMR, Ceder-creek) in Table \ref{tab_bivar_summary}, data were always significantly correlated as indicated by p-value (<0.05) from `BiCopIndTest`{`VineCopula`} (1$^{st}$ row of Table \ref{tab_bivar_summary}). Non-Normal copula were always emarged as best fit copula based on minimum AIC value (2$^{nd}$ row of Table \ref{tab_bivar_summary}). Normal copula were found as poor fit compared to highest AIC-weight based asymmetric copulae (3$^{rd}$ and 4$^{th}$ rows of Table \ref{tab_bivar_summary}) - which answers the first part of \hyperref[Intro]{\textbf{(Q1)}}. Goodness of fit of the best-fit asymmetric copulae were tested based on p-values from two statistics (Cramer-von Mises and Kolmogorov-Smirnov : 5$^{th}$ and 6$^{th}$ rows of Table \ref{tab_bivar_summary}, respectively).
Among 4 datasets presented there, first three have significantly stronger upper tail dependence whereas the last one has significantly stronger lower tail dependence compared to Normal (compare 7$^{th}$ and 8$^{th}$ rows of Table \ref{tab_bivar_summary}). It was indicated by negative AIC-weights model averaged (lower-upper) tail dependence (9$^{th}$ row of Table \ref{tab_bivar_summary}) for first 3 datasets and positive AIC-weights model averaged 
(lower-upper) tail dependence for the last one, which answers the second and third part of \hyperref[Intro]{\textbf{(Q1)}} (For detailed results of each dataset see Tables \ref{SM-tab_soilCNfit} - \ref{SM-tab_cc_asym_2000} and Figs. \ref{SM-fig_soilCN_nonparam} - \ref{SM-fig_cc2000_nonparam}). We also reported the rank of ($\Ps_l - \Ps_u$) for the actual copula data in camparison to the same non-parametric statistics of Kendall-correlation preserving 1000 Normal surrogates. Ranks if were $>$ 975 or $<$ 25, then indicated a significantly (95$\%$ CI) different lower tail-dependence or upper tail-dependence measures, respectively, based on Normal-null hypothesis. We found our model-selection results were consistent with non-parametric analysis for all the datasets (compare last two rows of Table \ref{tab_bivar_summary}). We will now discuss briefly findings from one of our bivariate datasets as follows.

### Example for bivariate case : soil C and N data \label{Ex_SoilCN}

```{r read_BivMS_soilCN_data,echo=F}
d<-readRDS("Data/RaCA_soilorganicC_soiltotalN_stocks100cm.RDS")
d<-d[,c("SOCstock100","TSNstock100")] #raw soilCN data
BivMS_res_Loecke<-readRDS("./Results/fitting_results/BivMS_soilCN.RDS")
```

As described in the \nameref{Data}, raw data plot for soil organic C and soil N stocks to 1m of soil depth from the central pedon of the `r nrow(d)` sites and their corresponding copula plot were presented in Fig. \ref{fig_biv_multi_raw_cop}(A) and (E), respectively.
We carried out model selection analysis and non-parametric statistics to measure tail-dependence (if any) on this copula plot.

<!--#### Model selection approach \label{Ex_SoilCN_Model_selection}-->

From the model selection approach, the test of indepedence gave $p=$ `r BivMS_res_Loecke$IndepTestRes` (to within the precision available from `BiCopIndTest` in the `VineCopula` package) that showed a significant correlation (Kendall's coefficient = `r round(BivMS_res_Loecke$TauVal,2)`). We then fitted several copulae (all $16$ families as mentioned in \nameref{Model_selection})
and got AIC values and upper- and lower-tail dependency estimates based on the fitted copulae (Table \ref{SM-tab_soilCNfit}). 
Based on AIC weights, `r BivMS_res_Loecke$InfCritRes$copname[which.max(BivMS_res_Loecke$InfCritRes$AICw)]` was the best fit. The table shows that several copulae are much better supported (higher AIC and BIC weights) than the Normal copula, answering the first part of \hyperref[Intro]{\textbf{(Q1)}} for these data. 

The model-averaged (AIC weights used for model averaging) lower-tail dependence statistic was `r BivMS_res_Loecke$relLTdep_AICw` and the model-averaged upper-tail dependence statistic was `r BivMS_res_Loecke$relUTdep_AICw`. These values are distinct from what a Normal copula would give (i.e., 0), answering the second part of \hyperref[Intro]{\textbf{(Q1)}} for these data. Although these results do convincingly show non-Normal copula structure, we should caution that because even the lowest-AIC copula was a poor fit, giving $p$-value `r BivMS_res_Loecke$GofRes_CvM` (to within the precision available from `BiCopGofTest` in the `VineCopula` package) in the Cramer-von Mises-based test of the goodness of its fit, and $p$-value `r BivMS_res_Loecke$GofRes_KS` in the Kolmogorov-Smirnov-based test of the goodness of fit. Therefore, we also verified this finding with \nameref{NPA} approach (see Fig. \ref{SM-fig_soilCN_nonparam}), where each of our statistics ($\cor$, $\Ps$, $\Dsq$), as computed for the ranges $0-0.1$, $0.1-0.2$, ..., $0.9-1$ (with $10$ number of bins), was compared to the distributions of values of the same statistic with the same ranges computed on 1000 Normal-copula surrogate datasets with similar Kendall or Spearman correlations, in different runs for Kendall and Spearman (Fig. \ref{SM-fig_soilCN_nonparam}). Each bin in each subplot of Fig. \ref{SM-fig_soilCN_nonparam} contains a number indicating how many surrogates out of 1000, are significantly different ($95\%$ confidence interval) from Normal-copula statistics. Those numbers clearly show that tail dependence of data is stronger in both the lower and upper tails than would be expected under a null hypothesis of a normal copula, answering the second part of \hyperref[Intro]{\textbf{(Q1)}}.

Furthermore, the difference of model-averaged tail dependence statistics (lower minus upper), `r BivMS_res_Loecke$relLTdep_AICw-BivMS_res_Loecke$relUTdep_AICw`, was different from 0, answering the third part of \hyperref[Intro]{\textbf{(Q1)}}. To be precise, this difference being negative, indicated stronger upper-tail dependence than lower, which was also supported by non-parametric results (see Table \ref{SM-tab_soilCN_asym}).

<!--#### Non-parametric analysis of tail dependence \label{Ex_SoilCN_NPA}-->

## Results for multivariate spatial data \label{Result_multi}
```{r read_RES_aphid_count, echo=F}
RES_aphid_count<-readRDS("./Results/fitting_results/AphidCopulaFit_selecloc_count_species_10.RDS")
```

We summarized our results columnwise in Table \ref{tab_multivar_summary} for all multivariable datasets 
(i.e., abundance data for green spruce aphid and firstflight date data for leaf-curling plum aphid from `r nrow(RES_aphid_count$gfc_numBS)` sampling locations, abundance data for plankton from UK seas from $14$ sampling locations, 
methane flux data from $13$ sampling locations). 

We found major occurence of non-independent copulae (row 2, Table \ref{tab_multivar_summary}) out of all pairwise locations (row 1, Table \ref{tab_multivar_summary}) considered. Non-Normal copulae, most of the time, emerged as best-fit based on minimum AIC out of 16 copula family considered (row 3, Table \ref{tab_multivar_summary}) answering the first part of question \hyperref[Intro]{\textbf{(Q1)}}. All four data sets showed Normal copulae were always poor fit in comparison to best-fit non-Normal copulae (compare their average AIC-weights from row 4 and row 5 of Table \ref{tab_multivar_summary}). We considered the "good-fit" location pair based on the p-values (>0.01) obtained from both Cramer-von Mises and Kolmogorov-Smirnov statistics (row 6, Table \ref{tab_multivar_summary}). Some spatial data (green spruce aphid's count, Ceratium furca's count and methane flux) showed stronger lower tail dependence (compare row 7 and row 8 from Table \ref{tab_multivar_summary}, also see row 9) whereas Leaf-plum curling's firstflight data showed stronger upper tail dependence which answered the second and third part of question \hyperref[Intro]{\textbf{(Q1)}}. Those spatial synchrony from model selection results were also verified by the non-parametric statistic which showed exclusively positive (or negative) confidence interval of the distribution $(\Ps_l - \Ps_u)$ estimated from all location pair for lower (or upper)- tail dependent spatial data (except methane-flux data which had marginal lower quantile). Methane flux data (last column of Table \ref{tab_multivar_summary}) did show that there were non-Normal copula as best fit for most of the location pair but its model-averaged lower tail dependence was not significantly stronger in non-parametric analysis results.

### Example for multivariate case : abundance data for the green spruce aphid, *Elatobium abietinum* \label{Ex_count}

<!--#### Model selection approach \label{Ex_count_Model_selection}-->

As described in \nameref{Model_selection}, for multivariable dataset like green-spruce aphid's abundance data, model selection among copulae was done separately for each pair of the 10 sampling locations, thus results are presented in $10 \times 10$ matrix format with rows and columns corresponding to locations. Table \ref{SM-tab_count_bestcop} shows that, for the large majority of location pairs, some non-Normal copula was a better fit, according to maximum AIC-weights, than was the Normal copula, answering the first part of question \hyperref[Intro]{\textbf{(Q1)}} for these data. Comparing the 
AIC weight of the best-fitting (lowest AIC) copula family for each pair of sampling locations (Table \ref{SM-tab_count_AICw}) to the AIC weight of the Normal copula family for the same pair (Table \ref{SM-tab_count_AICw_normal}) confirms that the degree of support for Normal copulae was usually not
comparable to the degree of support for other families.
Goodness of fit tests based on a Cramer-von Mises statistic (Table \ref{SM-tab_count_p_CvM}) in every case 
failed to reject the hypothesis that the AIC-best copula family was also an objectively adequate description of 
the data, and likewise for goodness of fit tests based on a Kolmogorov-Smirnov statistic (Table \ref{SM-tab_count_p_KS}), demonstrating that the collection of copula families we used was sufficiently broad that the copulae of all pairs of locations could be characterized by at least one of them. In all cases at least `r min((RES_aphid_count$gfc_numBS_success/RES_aphid_count$gfc_numBS),na.rm=T)*100`$\%$ of bootstrap randomizations used for goodness of fit tests successfully lead to values of the statistic for comparison with its value on the real data.

The model-averaged (averaging performed using AIC weights) lower-tail dependence statistic and the model-averaged (again, AIC based) upper-tail dependence statistic are in Tables \ref{SM-tab_count_LTdep_AICw} and \ref{SM-tab_count_UTdep_AICw} respectively. These values were exclusively positive, thereby differing from what a normal copula would give (i.e., 0), and answering the second part of question \hyperref[Intro]{\textbf{(Q1)}} for these data. Apparently these aphid data have greater tail dependence (both lower and upper) than would be expected from a normal-copula null hypothesis. 

The difference between the model-averaged lower-tail dependence statistic and the model-averaged upper-tail dependence statistic (lower minus upper), shown in Table \ref{SM-tab_count_LTmUT}, is positive for all but a few locations pairs (`r sum((RES_aphid_count$LTdep_AICw-RES_aphid_count$UTdep_AICw)>0,na.rm=T)` out of `r (dim(RES_aphid_count$gfc_p_CvM)[1]^2-dim(RES_aphid_count$gfc_p_CvM)[1])-2*RES_aphid_count$num_indep_loc_pair`), answering the third part of question \hyperref[Intro]{\textbf{(Q1)}}. Fig. \ref{fig_biv_multi_raw_cop}(I) and (J) represnt exemplary plots for aphid abundance (green spruce aphid) raw data and its copula form at $(4,11)$ location pair which shows stronger lower tail dependence.

<!--#### Non-parametric analysis of tail dependence \label{Ex_count_NPA}-->

As mentioned in \nameref{NPA} and Appendix \ref{SM-spatial_resamp}, mean values of our statistics ($\cor_l$, $\cor_u$, $\Ps_l$, $\Ps_u$, $\Dsq_l$, $\Dsq_u$, 
$\cor_l-\cor_u$, $\Ps_l-\Ps_u$, $\Dsq_u-\Dsq_l$), as well as mean Kendall and Spearman correlations, were 
computed across all pairs of sampling locations, and confidence intervals of these means were computed via a spatial
resampling scheme (Table \ref{SM-tab_count_resamp}). Confidence intervals of
$\cor_l$, $\cor_u$, $\Ps_l$, $\Ps_u$, $\Dsq_l$, and $\Dsq_u$ always excluded zero and mean values were positive,
indicating tail dependence. Confidence intervals of $\cor_l-\cor_u$, $\Ps_l-\Ps_u$, $\Dsq_u-\Dsq_l$ also always 
exluded $0$ and were positive, indicating asymmetry of tail dependence (stronger lower tail dependence than upper), a feature that data with Normal copula structure do not have, providing further evidence answering the third part of question \hyperref[Intro]{\textbf{(Q1)}}. Visual illustration of this results were discussed in Appendix \ref{SM-visual_npa}.

<!--
```{r tab_bivar_summary, echo=F, results='markup'}
tab_bivar_summary<-readRDS("./Results/tab_bivar_summary.RDS")
knitr::kable(tab_bivar_summary, 
             format='pandoc',
             caption = "Summary of results for bivariate data-sets : \\textbf{p.Independence.test}: p-value from `BiCopIndTest`, \\textbf{minimumAIC.bestfit.copula}: best fit copula based on minimum AIC, \\textbf{Bestfit.copula.AICw}: AIC-weight of that best fit copula, \\textbf{Normal.copula.AICw}: AIC-weight of Normal copula, \\textbf{p.CvM}: p-value from `BiCopGofTest` for Cramer-von Mises method, \\textbf{p.KS}: p-value from `BiCopGofTest` for Kolmogorov-Smirnov method,\\textbf{LT.model.avg}: AIC-weights model averaged lower tail dependence, \\textbf{UT.model.avg}: AIC-weights model averaged upper tail dependence, \\textbf{(LT-UT).model.avg}:  AIC-weights model averaged (lower-upper) tail dependence. Statistic $\\Ps_l$ - $\\Ps_u$ for the actual copula data and for Kendall-correlation preserving $1000$ Normal surrogates were computed and ranked in ascending order. Rank for real data \\textbf{Rank.(Pl-Pu)}, if were $>975$ or $<25$, then indicated a significantly ($95\\%$ CI) different lower or upper tail-dependent measures based on Normal-null hypothesis.
\\label{tab_bivar_summary}",
             booktabs=TRUE)
```

```{r tab_multivar_summary, echo=F, results='markup'}

tab_multivar_summary<-readRDS("./Results/tab_multivar_summary.RDS")
knitr::kable(tab_multivar_summary, 
             format='pandoc',
             caption = "Summary of results for multivariate data-sets : \\textbf{num.pairs}: total number of location pairs (excluding self-comparison) considered, \\textbf{num.non-indep}: how many location pair copula are non-independent among them, \\textbf{num.non-N}: number of non-Normal copula as best fit (based on highest AIC-weight), \\textbf{Avg.best.AICw}: average AIC-weights of best fit copula from all location pair, \\textbf{Avg.N.AICw}: average AIC-weights of Normal copula from all location pair, \\textbf{num.good.fit}: number of location pair for which best fit copula have p-values $>$ 0.01 
(both Cramer-von Mises and Kolmogorov-Smirnov method), \\textbf{0.025-CI.LT}: lower and \\textbf{0.975-CI.LT}: upper quantile ($95\\%$CI) of model averaged (AIC-weight based) lower tail dependence from all location pair, \\textbf{0.025-CI.UT}: lower and \\textbf{0.975-CI.UT}: upper quantile ($95\\%$CI) of model averaged (AIC-weight based) upper tail dependence from all location pair, \\textbf{num.LT-UT>0}: number of location pair which showed stronger lower tail dependence than upper, Last $6$ rows summarized the non-parametric analysis results for $\\Ps$ statistics : lower and upper quantile ($95\\%$CI) of $\\Ps_l$, $\\Ps_u$, $\\Ps_l-\\Ps_u$ based on resampling location pair.\\label{tab_multivar_summary}",
             booktabs=TRUE)
```
-->

<!--bivariate table summary in latex format-->
```{r tab_bivar_summaryl, echo=F, results='asis',message=F}
tab_bivar_summary<-readRDS("./Results/tab_bivar_summary.RDS")
row.names(tab_bivar_summary)<-NULL
library(kableExtra)
library(dplyr)
library(tibble)
dt <- tibble(Description = c("1. p-value from independence test",
           "2. Best fit copula based on minimum AIC",
           "3. AIC-weight of that best fit copula",
           "4. AIC-weight of Normal copula",
           "5. p-value from goodness of fit test for Cramer-von Mises method",
           "6. p-value from goodness of fit test for Kolmogorov-Smirnov method",
           "7. Model averaged (AIC-weights based) lower tail dependence",
           "8. Model averaged (AIC-weights based) upper tail dependence",
           "9. Model averaged (AIC-weights based) (lower - upper) tail dependence",
           "10. Rank of statistics (Pl-Pu) for real data in comparison to 1000 Normal surrogates")
)
tab_bivar_summary<-cbind(dt,tab_bivar_summary)
knitr::kable(tab_bivar_summary, 
             format="latex", 
             caption = "Summary of results for bivariate data-sets\\label{tab_bivar_summary}",
             booktabs=T, linesep = "\\addlinespace",
             col.names = c(" ", "SoilCN", "Birds’ BMR", "Mammals’ BMR", "Ceder-creek")
             )%>%column_spec(2:5,width="1.4cm")%>%
             column_spec(1, width = "11cm")%>%kable_styling(latex_options = "basic",position = "center")
```

<!--multivariate table summary in latex format-->

```{r tab_multivar_summaryl, echo=F, results='asis',message=F}
tab_multivar_summary<-readRDS("./Results/tab_multivar_summary.RDS")
tab1<-tab_multivar_summary[c(1:7,9,11,12,14,16),] # see carefully if you rearrange tab_multivar_summary's row
                                                   #in suppmat this will change
tab2<-tab_multivar_summary[c(8,10,13,15,17),]  # see carefully if you rearrange tab_multivar_summary's row
                                                   #in suppmat this will change

two_tab_in1 <- as.data.frame(do.call(cbind, lapply(1:ncol(tab1), function(i) paste0(" (",tab1[c(7:8,10:12),i], " , ",tab2[ , i], ")") )))   # see carefully if you rearrange tab_multivar_summary's row in suppmat this will change

colnames(two_tab_in1)<-colnames(tab_multivar_summary)
rownames(two_tab_in1)<-c("CI_LT","CI_UT","CI_Pl","CI_Pu","CI_Pl-Pu")

tab_multivar_summary<-rbind(tab_multivar_summary[c(1:6),],
                            two_tab_in1[1:2,], #CI of LT, CI of UT
                            tab_multivar_summary[11,],
                            two_tab_in1[5,] #CI of Pl-Pu
                           )

row.names(tab_multivar_summary)<-NULL
library(kableExtra)
library(dplyr)
library(tibble)
dt <- tibble(
            Description = c("1. Total number of location pairs (excluding self-comparison)",
           "2. Number of location pair having non-independent copula structures",
           "3. Number of non-Normal copula as best fit",
           "4. Average AIC-weights of best fit copula from all location pair",
           "5. Average AIC-weights of Normal copula from all location pair",
           "6. Number of good-fit location pair*",
           "7. 95% CI of model-avg. lower tail-dep. from all location pair",
           "8. 95% CI of model-avg. upper tail-dep. from all location pair",
           "9. Number of location pair showing stronger lower tail dependence",
           "10. 95% CI of (Pl - Pu) from all location pair")
           )

tab_multivar_summary<-cbind(dt,tab_multivar_summary)

knitr::kable(tab_multivar_summary, 
             format="latex", 
             caption = "Summary of results for multivariate data-sets\\label{tab_multivar_summary}",
             booktabs=T, linesep = "\\addlinespace",
             col.names = c(" ","Green-spruce aphid's count",
                        "Leaf-plum curling aphid's firstflight",
                        "Ceratium furca's count","Methane-flux")
             )%>%column_spec(2:5,width="2.5cm")%>%
             column_spec(1, width = "7cm")%>%kable_styling(latex_options = "basic",position = "center")%>%
   add_footnote("Good fit was considered for best fit copula with p-values > 0.01 (both Cramer-von Mises and Kolmogorov-Smirnov method)", notation="symbol", threeparttable = T, escape = F)
```

\begin{figure}[!h]
\textbf{ \hspace{2.8 cm} (A) \hspace{3.2 cm} (B) \hspace{3.2 cm} (C) \hspace{3.2 cm} (D) } \\
\vspace{-0.35 cm}
\begin{center}
\includegraphics[width=4 cm]{./Results/SoilCNraw.pdf}
\includegraphics[width=4 cm]{./Results/BMR_results/birds/raw_birds_BMR.pdf}
\includegraphics[width=4 cm]{./Results/BMR_results/mammals/raw_mammals_BMR.pdf}
\includegraphics[width=4 cm]{./Results/Ceder_creek_results/raw_HB_2000.pdf}\\
\end{center}
\textbf{ \hspace{2.8 cm} (E) \hspace{3.2 cm} (F) \hspace{3.2 cm} (G) \hspace{3.2 cm} (H) } \\
\vspace{-0.35 cm}
\begin{center}
\includegraphics[width=4 cm]{./Results/SoilCNcop.pdf}
\includegraphics[width=4 cm]{./Results/BMR_results/birds/copula_birds_BMR.pdf}
\includegraphics[width=4 cm]{./Results/BMR_results/mammals/copula_mammals_BMR.pdf}
\includegraphics[width=4 cm]{./Results/Ceder_creek_results/cop_HB_2000.pdf}\\
\end{center}
\textbf{ \hspace{2.8 cm} (I) \hspace{3.2 cm} (J) \hspace{3.2 cm} (K) \hspace{3.2 cm} (L) } \\
\vspace{-0.35 cm}
\begin{center}
\includegraphics[width=4 cm]{./Results/Aphid_count_raw_loc_4_11.pdf}
\includegraphics[width=4 cm]{./Results/Aphid_count_cop_loc_4_11.pdf}
\includegraphics[width=4 cm]{./Results/Aphid_ff_raw_loc_2_5.pdf}
\includegraphics[width=4 cm]{./Results/Aphid_ff_cop_loc_2_5.pdf}
\caption{Upper panel shows raw data plots for \textbf{(A)} soil C and N data, \textbf{(B)} log(BMR) vs. log(mass) for birds, \textbf{(C)} log(BMR) vs. log(mass) for mammals, \textbf{(D)} above-ground plant biomass data vs. Shannon's index (H) averaged over 9m by 9m plots for year 2000 of Ceder-creek experiment.
Middle panel \textbf{(E - H)} shows copula plots for the corresponding datasets of the upper panel. Lower panel shows \textbf{(I)} raw data , \textbf{(J)} copula plot for  green spruce aphid's count data from location pair(4,11) and \textbf{(K)} raw data , \textbf{(L)} copula plot for leaf-curling plum aphid's firstflight data from location pair(2,5).\label{fig_biv_multi_raw_cop}}
\end{center}
\end{figure}


<!--Question 2 analyses-->
# Some possible causes of non-Normal copula structure \label{Causes}

This section is dedicated to explore question \hyperref[Intro]{\textbf{(Q2)}} from \nameref{Intro}. 
<!--We wanted to find how are copula structure of ecologically influential climate variables changing as part of climate change?--> 

<!--Moran effects-->
\textbf{(i)} We were interested to explore the basic idea of Moran's theorem that if noise $\epsilon_{1}(t)$ and $\epsilon_{2}(t)$ at two different habitat patches had some specific assymetric tail dependence and then what will be the outcome dependence in the populations at those habitat patches. Should their dependence be exactly the same as of the noises or not ? 

To begin with, we chose a two habitat patch ($i = 1, 2$) with AR(1) model [Eq. \ref{eq.AR1}] where population $P_{i}$ at time $(t+1)$ depends upon its past value at $(t)$ and the iid noise (assumed to be caused by environmental fluctuations) $\epsilon_{i} (t)$.  

\begin{equation}\label{eq.AR1}
P_{i}(t+1)=\beta P_{i}(t)+\alpha \epsilon_{i}(t)
\end{equation}

To keep $Var(P_{i}(t+1))$ equal to unity, we set noise coefficient $\alpha$ in terms of AR coefficient $\beta$ as $\alpha = \sqrt(1-\beta^2)$. 

To test environmental effect on population copula, our approach is of two way : 

* First, we calculated the parameters of the noise-copula (for example, we chose Clayton with lower tail dependence) using `iRho` or `iTau` function from `copula` package for Spearman's Rho or Kendall's Tau, respectively. Then we simulated our model (\ref{eq.AR1}) and estimated parameters of the outcome bivariate population-copula, with last $500$ simulated points for each habitat patch (see Fig. \ref{fig_Cause4copula_params_GOF_500}). We also tested the goodness of fit of the estimated parameters for population-copula and its standard error due to sample size. We reported p-values from goodness of fit tests for both statistics (Cramer-von Mises and Kolmogorov-Smirnov). p-values greater or equal to $0.05$ (above the dashed line in Fig. \ref{fig_Cause4copula_params_GOF_500}) were considered as a good fit of estimated parameters. Fig. \ref{SM-fig_Cause4copula_params_GOF_2500} represents similar feature as of Fig. \ref{fig_Cause4copula_params_GOF_500} but here we considered last $2500$ simulated population data points for our parameters-estimation, thus making our comparison more sensitive on basis of p-value threshold at $0.05$. (For code see [`Plotter_Cause4copula_GOF`](https://github.com/sghosh89/BIVAN/blob/master/Cause4copula.R) function). 

\begin{figure}[!h]
\begin{center}
\includegraphics[width=16 cm]{./Results/Cause4copula_results/compare_params_pGOF_num_keep_last_500.pdf}
\caption{Results of comparison between the parameters of environmental noise generated from a specific family of copula and estimated sample parameter (with some standard error) of the affected populations (Initially 5000 points are generated but we kept last 500 points for both noise and population data for comparison). p-values $> 0.05$ (above horizontal dashed line) indicate good fit of population copula with same noise cpoula family. \label{fig_Cause4copula_params_GOF_500}}
\end{center}
\end{figure}

* Next, we measured 3 types of correlations (Spearman, Kendall, Pearson) and different types of non-parametric tail-dependence statistics (see \nameref{NPA}) for both bivariate noise copula and resultant population copula (following model \ref{eq.AR1}) for $50$ simulations. Then we plotted mean of each measured quantity with standard error against Kendall's Tau of the noise copula family. Fig. \ref{SM-fig_Cause4copula_C_kend} compares the statistics from population copula and the copula made of noises drawn from lower tail dependent Clayton family. It is possible to measure the statistics with variation of Spearman's Rho for any other noise copula family (e.g. see Fig. \ref{SM-fig_Cause4copula_SC_spear}). We also carried out a paired t-test to compute the p-values of each statistic for noise and population data and found that like our first approach (model selection method), here also the nature of tail dependence in noise and populations remained similar but they were not exactly the same except in Pearson correlation coefficient which ensured the Moran effect on the population data caused by environmental noise. (For code see [`Plotter_Cause4copula_stat`](https://github.com/sghosh89/BIVAN/blob/master/Cause4copula.R) function). Linear regression between tail statistics from noise and population copula (Fig. \ref{fig_Cause4copula_scatter_C_kend}) confirmed that the asymmetric tail dependence in noise copula caused similar tail dependence in population copula.

\begin{figure}[!h]
\begin{center}
\includegraphics[width=5 cm]{./Results/Cause4copula_results/Cause4copula_stat_results/Clayton_scatter_CorlmCoru_Kendall's Tau.pdf}
\includegraphics[width=5 cm]{./Results/Cause4copula_results/Cause4copula_stat_results/Clayton_scatter_PlmPu_Kendall's Tau.pdf}
\includegraphics[width=5 cm]{./Results/Cause4copula_results/Cause4copula_stat_results/Clayton_scatter_D2umD2l_Kendall's Tau.pdf}
\caption{Linear regression between 3 non-parametric stats ($\cor_l - \cor_u$, $\Ps_l - \Ps_u$ and $\Dsq_u - \Dsq_l$) of environmental noise generated from lower tail dependent Clayton copula and of the affected populations for 9 equidistant Kendall's Tau values in a range (0.1 to 0.9 as shown in Fig. \ref{SM-fig_Cause4copula_C_kend}) showed significant pearson correlation, and henceforth confirmed asymmetric tail dependence in noise copula caused similar tail dependence in population copula. Regression line (black) differing from 1:1 line (green) indicates that asymmetric tail dependence in noise and population copulae are similar but not exactly same.\label{fig_Cause4copula_scatter_C_kend}}
\end{center}
\end{figure}

<!--Asymmetric sensitivity and copula structure in populations-->
\textbf{(ii)} On a second note, we intended to see if any specific (lower or upper) tail dependence emerges from a copula of two meta-populations, due to some global environmental factors (like temperature or snowfall) when beyond a certain expectation threshold it behaved differently. 

To test the assymetric sensitivity, we constructed a two habitat patch model for population $P_{i} (i=1,2)$ as follows;

\begin{equation}\label{eq.AS}
P_{i}(t+1) = b P_{i}(t) + g(\varepsilon_{i}(t)) + h(\delta_{i}(t))
\end{equation}

$b$ was the linear growth rate. Global environmental fluctuation function $g(\varepsilon)$ can take up any one form between $g_{1}$ and $g_{2}$ (Eq. \ref{eq.AS_g}) where $\varepsilon=(\varepsilon_{1}, \varepsilon_{2})$ was an iid through time with mean zero and covariance matrix $\Sigma_{\varepsilon}$.

\begin{align}
g(\varepsilon) = \begin{cases} 
g_{1} = \begin{cases}
\varepsilon & \text{if $\varepsilon< 0$}; \\
0 & \text{otherwise}.
\end{cases}\\ \\
g_{2} = \begin{cases}
\varepsilon & \text{if $\varepsilon> 0$}; \\
0 & \text{otherwise}\label{eq.AS_g}.
\end{cases}
\end{cases} \text{where } \varepsilon = N(\textbf{0},\Sigma_{\varepsilon})\;\ \text{with} \;\ \Sigma_{\varepsilon} = \begin{bmatrix} 1 & r \\ r & 1 \end{bmatrix}
\end{align}

Local environmental fluctuation function $h(\delta)$ varied according to Eq. \ref{eq.AS_h} where $a$ was the scaling parameter between $0$ to $1$. $\delta=(\delta_{1}, \delta_{2})$ was an iid across $i=(1,2)$ and time with mean zero and covariance matrix $\Sigma_{\delta}$.

\begin{equation}\label{eq.AS_h}
h(\delta) = a \delta = aN(\textbf{0},\Sigma_{\delta})\;\ \text{with} \;\ \Sigma_{\delta} = \begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}
\end{equation}

We simulated our model (\ref{eq.AS}) for $b=0.1$ , $a=0.2$, $r=0.8$. $10000$ points were generated from each local and global fluctuations to apply on the initial populations and then after simulation we kept only last $1000$ time step of simulated points to plot the population-copula (Fig. \ref{fig_ms_asym_b_0.1}) for a specific functional form of $g$  (For code see [`Simulator_asym_sens`](https://github.com/sghosh89/BIVAN/blob/master/asym_sensitivity.R) function). When asymmetric global noise
had only non-positive contributions at two habitat patches ($g_{1}$ in the first panel of Fig. \ref{fig_ms_asym_b_0.1}), lower tail dependence appeared in the global noise copula and so thus in affected population copula (last subplot in the first panel of Fig. \ref{fig_ms_asym_b_0.1}). Similarly, when global noises having only non-negative contributions at two habitat patches ($g_{2}$ in the second panel of Fig. \ref{fig_ms_asym_b_0.1}), upper tail dependence appeared in the global noise copula and so thus in the outcome population copula (last subplot in the second panel of Fig. \ref{fig_ms_asym_b_0.1}). We also carried out model selection and non-parametric statistical analysis with each copula of Fig. \ref{fig_ms_asym_b_0.1} and summarized our results in Tables \ref{SM-tab_summary_stat_asym_sens} - \ref{SM-tab_stat_npa_asym_2}. According to our model selection approach (Table \ref{SM-tab_summary_stat_asym_sens}), non-normal copulae (with higher AIC weights) were always best-fit with similar asymetric tail dependence which gave the support of our hypothesis of the effect of asymmetric global noise copula on populations. Our non-parametric analysis results (Tables \ref{SM-tab_stat_npa_asym_1} -\ref{SM-tab_stat_npa_asym_2}) were consistent with the model selection approach. 

\begin{figure}[!h]
\begin{center}
\includegraphics[width=16 cm]{./Results/asym_sens_results/a_0.2_b_0.1_r_0.8_asym_sens.pdf}
\caption{Effects of asymmetric global noise copula on two habitat patch model (Eq. \ref{eq.AS}) with growth rate $b=0.1$: copula of two populations ($P_{1}, P_{2}$) shaped according to the asymmetry of noise copula\label{fig_ms_asym_b_0.1}}
\end{center}
\end{figure}

<!--We now know the copula structure of environmental variables can induce (sometimes similar but not the same) copula structure in the populations, but we don’t really know how a change in the environment copula structure would make what kind of change in the population copula structure.--> 
<!--
## Application : The Moran effect and copula structure in population 

```{r read_RES_temp_aphid, echo=F}
RES_temp_aphid<-readRDS("./Results/fitting_results/AphidCopulaFit_selecloc_winter_neg_temp.RDS")
```

Firstly, Our hypothesis was if a non-normal copula structure describes the dependence of an environmental
variable between two locations, then there can be a non-normal copula structure for the
dependence of populations in the locations that are influenced by the environmental variables. This assumption was inspired by the the idea of Moran-effect [@Moran1953] which was originally used to explain synchronization of widely dispersed populations. In the previous section, we already tested our hypothesis with a two habitat patch model (1st order AR method) in noisy environment (having non-Normal copula structure) and found that populations were shaped by similar copula structure as that of local noises. Here, we investigated the probable cause of upper tail dependence in the leaf-curling plum aphid's firstflight date throughout all the locations. We assumed that average winter temperature which might be spatially synchronized and had asymmetric tail dependence cause the synchronized delay in leaf-plum curling aphid's appearence. We tested our hypothesis and indeed found the Moran effect on leaf-plum curling aphid's firstflight data induced by average winter temperature for the period of 35 years (1976-2010). We did pair wise model selection with negative average winter temperature (averaged over (n-1)$^{th}$ December to n$^{th}$ March temperature) from the selected 10 locations for which we did model selection with aphid-firstflight data. Negative winter temperature was considered for simulation to compare the aphid's firstflight results with temparature copula (aphid's firstflight date were negatively correlated with temperature or in other words positively correlated with negative temparature). Model selection results for negative average winter temperature in 10 $\times$ 10 matrices were represented in Table \ref{SM-tab_temp_aphid_bestcop} - Table \ref{SM-tab_temp_aphid_LTmUT}. In all cases `r min((RES_temp_aphid$gfc_numBS_success/RES_temp_aphid$gfc_numBS),na.rm=T)*100` $\%$ of bootstrap randomizations used for goodness of fit tests successfully lead to values of the statistic for comparison with its value on the real data. Table \ref{SM-tab_temp_aphid_LTmUT} showed `r sum(RES_temp_aphid$LTdep_AICw - RES_temp_aphid$UTdep_AICw <0, na.rm=T)` out of `r (dim(RES_temp_aphid$gfc_p_CvM)[1]^2-dim(RES_temp_aphid$gfc_p_CvM)[1])-2*RES_temp_aphid$num_indep_loc_pair` location pair showed upper tail dependence in temperature copula, which can be considered as the Moran effect results causing dominant upper tail dependence in the copulae with aphid's firstflight date (Table \ref{SM-tab_ff_LTmUT}). -->

### Need to think about mechanisms for biogeochemical, evolutionary, and community data

<!--Question 3 analyses-->
# Consequences of non-Normal copula structure and tail dependence for our understanding of biology and for applications? \label{Consequences}

This section is attributed to analysis of question \hyperref[Intro]{\textbf{(Q3)}} from \nameref{Intro}. We found that asymmetric tail dependence had **(i)** effects on skewness of spatially averaged time series data. Because of overall distinct tail dependence of the multivariate copula structure, the skewness of the spatially-averaged time-series data, changed significantly from the individual skewness of time-series data. To test null hypothesis $H_{0}$ which presumed that multivariate copula actually came from normal copula structure, we generated $10000$ number of surrogate normal copula from a given multivariate copula keeping the marginal distribution and the correlation (spearman or kendall) same. Then we calculated the skewness of spatially averaged surrogate time series data, as we did with the actual multivariate data set (For code see [skewness_multivar_dataset.R](https://github.com/sghosh89/BIVAN/blob/master/skewness_multivar_dataset.R)). We made a histogram of surragate skewness and found if actual skewness were within $95\%$ confidence interval or not. If $p$-value is less than $0.05$, then we reject the null hypothesis in support of significant tail dependence (and henceforth significantly different skewness than Normal copula).

We also showed **(ii)** asymmetric copula structure affected slope of spatial Taylor's Law differently than as expected from symmetric Normal copula (For details see Appendix \ref{SM-Consequence_TL_simulation}). For example, our model simulation showed lower tail dependent Clayton copula had much higher slope (spatial-Taylor's law) than symmetric Normal copula, which in turn had higher slope than upper tail dependent Survival Clayton family (Fig. \ref{SM-fig_spTL}(I)). 

In the following section we will show application of these ideas with real datasets.
<!-- Extinction risk results are not shown currently, it is introduced as a future idea in Discussion-----------
Finally, we studied **(iii)** the effects of environmental noise, having a non-Normal copula, on extinction risk (calculated after 25 years) with two metapopulation model, namely, Lewton-Cohen model and Ricker model (For details see Appendix \ref{SM-Consequence_ext_risk}). We considered patches were arranged in a linear chain fashion and the population may disperse to its nearerst two neighbors (local dispersion) or to any patches (global dispersion). For both model with both dispersion, increasing number of habitat patches and increasing carrying capacity, separately, had decreased extinction risk of the populations which was expected (Fig. \ref{SM-fig_risk_numlocs_effect_local_disp} - Fig. \ref{SM-fig_risk_K_effect}). For Lewton-Cohen model, we found greater extinction risk if populations were affected by left tail dependence environmental noise copula than right tail dependent one. For Ricker model, we got the similar observation for smaller values of $r$, the intrinsic growth rate, but for higher values of $r$, there was a turn-over in extinction risks, and right tail dependent noise copula caused population go extinct faster. -->

\begin{figure}[!h]
\textbf{ \hspace{6 cm} (A) \hspace{6 cm} (B)} \\
\vspace{-0.1 cm}
\begin{center}
\includegraphics[width=8 cm]{./Results/skewness_results/skewness_aphid_count/skewness_aphid_count_sp_10_spearman.pdf}
\includegraphics[width=8 cm]{./Results/skewness_results/skewness_aphid_ff/skewness_aphid_ff_sp_11_spearman.pdf}\\
\end{center}
\vspace{0.2 cm}
\textbf{ \hspace{6 cm} (C) \hspace{6 cm} (D)} \\
\vspace{-0.1 cm}
\begin{center}
\includegraphics[width=8 cm]{./Results/skewness_results/skewness_plankton_north_sea/skewness_plankton_north_sea_sp_16_spearman.pdf}
\includegraphics[width=8 cm]{./Results/skewness_results/skewness_methane/skewness_methane_spearman.pdf}
\caption{Skewness of spatially averaged $(A)$ green-spruce aphid's abundance, $(B)$ leaf-curling plum aphid's firstflight date, $(C)$ ceratium furca's abundance and $(D)$ methane-flux data, were indicated by red dot in each plot and were compared with respect to skewness of spatially averaged 10000 Normal surrogates preserving Spearman correlation). \label{fig_skewness_spearman}}
\end{center}
\end{figure}

## Application : Change of skewness

We used our four multivariate datasets : aphid-count data, aphid-firstflight data, plankton data and methane-flux data, to compute skewness of spatially averaged data. We tested null hypothesis $(H_{0})$ which presumed that multivariate copula actually came from normal copula structure with no tail dependence and thus should have the same skewness as of normal copula. If $p$-value is less than $0.05$, then we reject the null hypothesis in support of significant tail dependence (and henceforth significantly different skewness than Normal copula). We carried out the same analysis with aphid abundance and aphid firstflight date data for all 20 aphid species and plankton abundance data for all 22 plankton species. In each study, we got $>5\%$ positive results which gave us confidence in validating significantly different skewness for asymmetric copula than Normal. For example, Figure \ref{fig_skewness_spearman} represents the results for each dataset with Spearman correlation preserving surrogates. Figure \ref{fig_skewness_spearman}(A) showed that averaged skewness (indicated by red dot) was much lower than expected if the aphid count data came from a normal copula. In that example, $p$ value was denoted by the fraction of surrogate-skewness which were lower than the averaged skewness of the given data. As $p<0.05$, we rejected $H_{0}$ in support of significantly stronger lower tail dependence which was also consistent with the non-parametric analysis and model fitting results (see first column of Table \ref{tab_multivar_summary}). On the other hand, Figure \ref{fig_skewness_spearman}(B) demonstrated that averaged skewness was much higher than expected if the aphid first flight data came from a normal copula. As $p$ value (the fraction of surrogate-skewness which were greater than the averaged skewness of the given data - red dot in Figure \ref{fig_skewness_spearman} B) was less than $0.05$, we reject $H_{0}$ in support of upper tail dependence, which was also confirmed by model selection and non-parametric results(see second column of Table \ref{tab_multivar_summary}). Figure \ref{fig_skewness_spearman}(C) showed that averaged skewness was lower than expected if the plankton data came from a normal copula. Our previous results on non-parametric analysis and model fitting also supported lower tail dependence (see third column of Table \ref{tab_multivar_summary}). But, as $p>0.05$, we could not reject $H_{0}$ in that case. Finally, for methane-flux data, the averaged skewness was lower than expected if the data came from a normal copula (Figure \ref{fig_skewness_spearman} D). As $p<0.05$, we rejected $H_{0}$ and that result too was consistent with the non-parametric analysis and model selection results which also favored lower tail dependence (see last column of Table \ref{tab_multivar_summary}). We found the same result when we repeated our simulation with Kendall correlation preserving surrogates (see Fig. \ref{SM-fig_skewness_kendall}).


## Application : Change of curvature of spatial Taylor's law regression line

Spatial Taylor's law, which shows linear relationship between `log`(variance) and `log`(mean) of population densities of a species from different locations, is a well-known pattern found in ecology and related fields [@Taylor1961, @Taylor1988, @Cohen2013, @Doring2015, @Kuo2016, @Xu2016, @Reuman2017]. We already showed through simulation (Appendix \ref{SM-Consequence_TL_simulation}) that for asymmetric copula this linear relationship somehow deviates compared to Normal copula which was presumed to have gamma marginals. We tested spatial Taylor's law with aphid's count data (for all 20 species) and found that the mean curvature of the regression line from `log`(variance) vs. `log`(mean) of population abundance data was significantly different from $10000$ Normal surrogates (Spearman-correlation and marginal distribution preserving) for $25\%$ of total species considered. For example, species "Corn leaf aphid" (having significantly upper tail dependence from model selection and non-parametric analysis) showed mean curvature of regression line close to zero, whereas it's one of the $10000$ Normal surrogate showed a higher curvature, indicating here Normal copula didn't hold linear relationship between `log`(spatial variance) and `log`(spatial mean) (see Fig \ref{fig_sTL_mncurv_sp6}). 

\begin{figure}[!h]
\textbf{ \hspace{4 cm} (A) \hspace{4 cm} (B) \hspace{4 cm} (C)} \\
\vspace{-0.5 cm}
\begin{center}
\includegraphics[width=10 cm]{./Results/taylorslaw_results/aphid_count_sp6_logv_vs_logm.pdf}
\includegraphics[width=5 cm]{./Results/taylorslaw_results/aphid_count_sp6_sTL_mncurv.pdf}\\
\caption{log(spatial variance) and log(spatial mean) for $(A)$ corn-leaf aphid's abundance and for $(B)$ one of the $10000$ Normal surrogates (having same marginal distribution and Spearman correlation of actual data). $(C)$ Histogram of mean curvature of $10000$ normal surrogates showed that for leaf plum corn aphid's abundance data (with asymmetric tail dependence), Normal surrogates didn't follow linear relationship between log(spatial variance) and log(spatial mean). \label{fig_sTL_mncurv_sp6}}
\end{center}
\end{figure}

# Discussion \label{Discussion}

<!--what we did and why is it important to study?-->

In the earlier work, most of the studies in ecology focused on measuring correlations between variables and thus ignoring the possibility to recognize importance of stronger association between extreme values of them. In the present study, we introduced the concept of asymmetric tail-dependence and non-Normal copulae in this field. We showed by examples of several real data set (Table \ref{tab_bivar_summary} and Table \ref{tab_multivar_summary}) that non-Normal copulae with specific tail dependence is common in nature and could tell us about the nature of interaction between different ecological variables. Our method in this regard of two ways. First, we did a model selection approach based on maximum likelihood which fit the real copula data with an optimal set of 16 copulae family. These copulae were chosen carefully so that they covered the whole range from exclusively lower (Clayton, Survival Gumbel, Survival Joe, Survival BB6, Survival BB8) or upper tail dependence (Survival Clayton, Gumbel, Joe, BB6, BB8) to both tail dependence (BB1, Survival BB1, BB7, Survival BB7) in addition to two symmetric copulae (Normal and Frank). Copula having highest AIC-weight came as best-fit from this approach. Though we did goodness of fit test based on two statistics (Cramer-von Mises and Kolmogorov-Smirnov), still we wanted to make sure the reliability of our model selection results. So, on a second note, we measured the tail dependence at both lower and upper end of a copula by three different non-parametric statistics ($\cor$, $\Ps$ and $\Dsq$) which we innovated and we found they were consistent with the inferences we drew from model selction results. Our approach of "copula" could help to interprete the synchronous behavior of a species from several metapopulations. To illustrate, if pairwise copulae from a multivariate spatial data of a species (e.g. abundance data of green-spruce aphid) showed major "lower-tail dependence" on most of the locations then it could be considered as a signature of "spatial synchrony" that metapopulations are simultaneously rare at those locations. So, if some aphid species showed synchronously "upper-tail dependence" then it would be harmful for corp-production or in case of synchronous abundance of planktons could lead to algal-bloom in the ocean. Copula could also gave us information about the causal relationship between ecological variables. For example, if maximum railfall is beneficial for some species then it would show an upper-tail dependent copula where high values of species abundance and precipitation would be strongerly correlated then lower values. 

We explained the possible causes which induced asymmetric tail-dependence in copula. Borrowing the idea from "Moran's theorem", we demonstrated with simulations that two habitat patches when affected by asymmetric bivariate-noise copula showed similar tail-dependence asymmetry in the population copula from those patches (see Fig. \ref{fig_Cause4copula_params_GOF_500} and Fig. \ref{fig_Cause4copula_scatter_C_kend}). We also showed the effect of global environmental fluctuation (behaving asymmetrically beyond a certain threshold) on the meta-population copula which was shaped with similar tail dependence as of the initial global noise copula (Fig. \ref{fig_ms_asym_b_0.1}). We observed significant changes in skewness of spatially averaged timeseries and also in the curvature of spatial Taylor's law for copula having asymmetric tail-dependence than it would have been expected for Normal copula. For example, Fig. \ref{fig_skewness_spearman}(A) showed green spruce aphid's abundance timeseries had right skewed distribution but its skewness was signifiantly lower than it was expected if it would came from its Spearman correlation preserving Normal surrogates. This result indicates less extreme outbreaks of green spruce aphid around UK than it would have been with Normal copula structure. Similarly, methane fluxes showing lower skewness than Normal surrogates mean that the level of green house gas is under-control situation and monitoring this skewness over several decades may be helpful to understand the "green-house effect" on environment. 

<!--future work-->
We think this copula approach have scope to investigate into the extinction risks of metapopulation due to climate change. To illustrate, lower-tail dependent environmental fluctuations may suppress the metapopulations synchronously by making some of the habitats go extinct. This could help in managing policy for conservation of endangered populations.  


\newpage
# References


